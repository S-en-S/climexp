#!/bin/sh
WMO=$1
outfile=$2
TYPE=`basename $0 | cut -b 9-10`
infile=KNMIData/$TYPE$WMO.gz
if [ -z "$outfile" -o ! -s "$outfile" -o "$outfile" -ot $infile ]; then
    # stdout is the same as outfile...
    gunzip -c $infile
fi
if [ -n "$outfile" ]; then
    ncfile=${outfile%.dat}.nc
    if [ ! -s $ncfile -o $ncfile -ot $infile ]; then
        maybefile=${infile%.gz}.nc
        if [ -s $maybefile ]; then
            cp $maybefile $ncfile
        else
            dat2nc $outfile $TYPE $WMO $ncfile
        fi
    fi
fi
